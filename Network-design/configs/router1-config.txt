!
! Router-1 Configuration
! Network Design, ACLs & Firewalls
! Role: Primary/Active router for VLANs 10, 20, 30
!

version 15.1
service timestamps debug datetime msec
service timestamps log datetime msec
no service password-encryption
!
hostname Router-1
!
!
! ===== DHCP CONFIGURATION =====
!
ip dhcp excluded-address 192.168.10.1 192.168.10.3
ip dhcp excluded-address 192.168.20.1 192.168.20.3
ip dhcp excluded-address 192.168.30.1 192.168.30.3
!
ip dhcp pool ADMIN-POOL
 network 192.168.10.0 255.255.255.0
 default-router 192.168.10.1
 dns-server 8.8.8.8
!
ip dhcp pool IT-POOL
 network 192.168.20.0 255.255.255.0
 default-router 192.168.20.1
 dns-server 8.8.8.8
!
ip dhcp pool FINANCE-POOL
 network 192.168.30.0 255.255.255.0
 default-router 192.168.30.1
 dns-server 8.8.8.8
!
!
! ===== INTERFACE CONFIGURATION =====
!
! WAN Interface to ISP
interface GigabitEthernet0/1
 description WAN Link to ISP-Router
 ip address 200.1.1.1 255.255.255.252
 ip nat outside
 ip access-group INBOUND-FILTER in
 ip access-group OUTBOUND-FILTER out
 duplex auto
 speed auto
!
! Inter-Router Link
interface GigabitEthernet0/2
 description Inter-Router Link to Router-2
 ip address 10.0.0.1 255.255.255.252
 duplex auto
 speed auto
!
! Trunk Interface to Switch-1
interface GigabitEthernet0/0
 description Trunk to Switch-1
 no ip address
 duplex auto
 speed auto
!
! VLAN 10 - Admin Department
interface GigabitEthernet0/0.10
 description Admin VLAN
 encapsulation dot1Q 10
 ip address 192.168.10.2 255.255.255.0
 ip nat inside
 standby 10 ip 192.168.10.1
 standby 10 priority 110
 standby 10 preempt
!
! VLAN 20 - IT Department
interface GigabitEthernet0/0.20
 description IT VLAN
 encapsulation dot1Q 20
 ip address 192.168.20.2 255.255.255.0
 ip nat inside
 ip access-group IT-SECURITY in
 standby 20 ip 192.168.20.1
 standby 20 priority 110
 standby 20 preempt
!
! VLAN 30 - Finance Department
interface GigabitEthernet0/0.30
 description Finance VLAN
 encapsulation dot1Q 30
 ip address 192.168.30.2 255.255.255.0
 ip nat inside
 standby 30 ip 192.168.30.1
 standby 30 priority 110
 standby 30 preempt
!
! VLAN 40 - Sales Department
interface GigabitEthernet0/0.40
 description Sales VLAN
 encapsulation dot1Q 40
 ip address 192.168.40.2 255.255.255.0
 ip nat inside
 ip access-group SALES-SECURITY in
 standby 40 ip 192.168.40.1
 standby 40 priority 100
 standby 40 preempt
!
!
! ===== ROUTING =====
!
! Default route to ISP
ip route 0.0.0.0 0.0.0.0 200.1.1.2
!
!
! ===== NAT CONFIGURATION =====
!
! Define networks allowed to use NAT
access-list 1 permit 192.168.10.0 0.0.0.255
access-list 1 permit 192.168.20.0 0.0.0.255
access-list 1 permit 192.168.30.0 0.0.0.255
access-list 1 permit 192.168.40.0 0.0.0.255
!
! Enable NAT overload (PAT)
ip nat inside source list 1 interface GigabitEthernet0/1 overload
!
!
! ===== SECURITY ACLs =====
!
! IT Department Security Policy
! Blocks IT from initiating connections to Admin and Finance
! Allows responses to requests from Admin and Finance
ip access-list extended IT-SECURITY
 permit tcp 192.168.20.0 0.0.0.255 192.168.10.0 0.0.0.255 established
 permit icmp 192.168.20.0 0.0.0.255 192.168.10.0 0.0.0.255 echo-reply
 permit tcp 192.168.20.0 0.0.0.255 192.168.30.0 0.0.0.255 established
 permit icmp 192.168.20.0 0.0.0.255 192.168.30.0 0.0.0.255 echo-reply
 deny ip 192.168.20.0 0.0.0.255 192.168.10.0 0.0.0.255
 deny ip 192.168.20.0 0.0.0.255 192.168.30.0 0.0.0.255
 permit ip any any
!
! Sales Department Security Policy
! Blocks Sales from initiating connections to Admin and Finance
! Allows responses to requests from Admin and Finance
ip access-list extended SALES-SECURITY
 permit tcp 192.168.40.0 0.0.0.255 192.168.10.0 0.0.0.255 established
 permit icmp 192.168.40.0 0.0.0.255 192.168.10.0 0.0.0.255 echo-reply
 permit tcp 192.168.40.0 0.0.0.255 192.168.30.0 0.0.0.255 established
 permit icmp 192.168.40.0 0.0.0.255 192.168.30.0 0.0.0.255 echo-reply
 deny ip 192.168.40.0 0.0.0.255 192.168.10.0 0.0.0.255
 deny ip 192.168.40.0 0.0.0.255 192.168.30.0 0.0.0.255
 permit ip any any
!
! Reflexive ACL - Outbound Filter
! Creates dynamic entries for outgoing connections
ip access-list extended OUTBOUND-FILTER
 permit icmp 192.168.10.0 0.0.0.255 any reflect REFLECT-LIST
 permit icmp 192.168.20.0 0.0.0.255 any reflect REFLECT-LIST
 permit icmp 192.168.30.0 0.0.0.255 any reflect REFLECT-LIST
 permit icmp 192.168.40.0 0.0.0.255 any reflect REFLECT-LIST
 permit tcp 192.168.10.0 0.0.0.255 any reflect REFLECT-LIST
 permit tcp 192.168.20.0 0.0.0.255 any reflect REFLECT-LIST
 permit tcp 192.168.30.0 0.0.0.255 any reflect REFLECT-LIST
 permit tcp 192.168.40.0 0.0.0.255 any reflect REFLECT-LIST
 permit udp 192.168.10.0 0.0.0.255 any reflect REFLECT-LIST
 permit udp 192.168.20.0 0.0.0.255 any reflect REFLECT-LIST
 permit udp 192.168.30.0 0.0.0.255 any reflect REFLECT-LIST
 permit udp 192.168.40.0 0.0.0.255 any reflect REFLECT-LIST
!
! Reflexive ACL - Inbound Filter
! Only allows return traffic for connections initiated internally
! Blocks unsolicited inbound connections
ip access-list extended INBOUND-FILTER
 evaluate REFLECT-LIST
 deny ip any 192.168.10.0 0.0.0.255
 deny ip any 192.168.20.0 0.0.0.255
 deny ip any 192.168.30.0 0.0.0.255
 deny ip any 192.168.40.0 0.0.0.255
 permit ip any any
!
!
! ===== VERIFICATION COMMANDS =====
!
! Useful commands for troubleshooting and verification:
! show ip interface brief
! show standby brief
! show ip nat translations
! show ip route
! show access-lists
! show ip dhcp binding
! show etherchannel summary
!
line con 0
line aux 0
line vty 0 4
 login
!
end
